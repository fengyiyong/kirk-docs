# 1.2 服务的内网访问和外网访问  

[1.2.1 服务的内网访问](#jump1)    
[1.2.2 服务的外网访问](#jump2)    

- [1.2.2.1 HTTP/HTTPS七层负载均衡](#jump21)    
- [1.2.2.2 TCP四层负载均衡](#jump22)

![](_figures/quick-start/cluster-app-netconfig.png)

***
## <span id="jump1">1.2.1 服务的内网访问</span>
容器在发生重启后，会出现内网IP的改变。这种情况下，如果还是通过IP+PORT的形式访问容器，会导致访问异常。因此容器的内网访问通过服务注册发现的机制来完成。操作如下：    

**1）填写监听的「容器端口」**

**2）选择容器的「通信协议」**

?> 服务创建后会自动添加DNS记录，服务以 **<服务名>:<服务端口>** 的形式暴露访问端口

![](_figures/quick-start/cluster-app-inside.png)
***

## <span id="jump2">1.2.2 服务的外网访问</span>
负载均衡可以扩展服务的访问能力到外网，平台支持「HTTP/HTTPS」七层和「TCP」四层两类负载均衡。
    
### <span id="jump21">1.2.2.1 HTTP/HTTPS七层负载均衡</span>
七层负载均衡可以通过两种方式挂载到服务：    
第一种是在「创建服务」时添加。    
第二种是先在「负载均衡」组件页面下创建负载均衡，再选择需要挂载的服务。    
这里以第一种为例，操作如下:    

**1）首先「开启负载均衡」。如果当前没有负载均衡实例，通过点击「添加」，创建一个负载均衡实例**

**2）下拉选择负载均衡实例，如果实例不存在，可以通过点击「添加」icon，创建一个新的负载均衡实例**

?> 创建负载均衡实例需要以下信息：		
   **名称·：**长度为2-64的小写字母、数字或"-", 不能以"-"开头或结尾。<br>
   **描述：**负载均衡的文本描述。<br>
   **计费方式：**负载均衡的计费方式，当前仅支持按流量计费。<br>
   **域名：**负载均衡绑定的域名。如果当前没有可用的域名，需要先去「域名管理」中添加<br>

![](_figures/quick-start/cluster-app-7loadbalance-on.jpg)

![](_figures/quick-start/cluster-app-7loadbalance-on2.png)


**3）填写「路径」，将域名下的某个子目录指向服务。**   
该服务的域名访问方式是 **<域名>/<路径>**

### <span id="jump22">1.2.2.2 TCP四层负载均衡</span>    
将四层负载均衡挂载到服务，操作如下：

**1）点击左侧菜单栏「负载均衡」，进入负载均衡组件页面**

**2）点击「TCP」，切换到TCP四层负载均衡子页面**

**3）点击「添加负载均衡」，打开负载均衡创建页**

?> 创建负载均衡实例需要以下信息：		
   **名称：**长度为2-64的小写字母、数字或"-", 不能以"-"开头或结尾。<br>
   **描述：**负载均衡的文本描述。<br>
   **后端服务：**选择负载均衡挂载到的服务。<br>
   **转发规则：**服务的「后端端口」。<br>
   
**4）点击「创建」，完成四层负载均衡的创建**    