# 1.1 基于镜像创建一个应用 {docsify-ignore-all}
一个应用一般由多个服务组成，所以创建一个应用就是创建多个服务并配置多个服务之间的依赖关系。开始创建一个应用，操作如下：

[1.1.1 选择空间](#jump1)
[1.1.2 添加应用](#jump2)    
[1.1.3 创建服务](#jump3) 
   
- [2.1.3.1 创建无状态服务](#jump31)    
- [2.1.3.2 创建有状态服务](#jump32)

## <span id="jump1">1.1.1 选择空间</span>

选择当前应用需要被创建在哪个空间下。空间彼此之间资源隔离，如果应用间有内网互访的需求，需要创建在一个空间下。操作如下：  
 
**1）下拉控制台顶部的「空间」进行空间切换**

![下拉选择空间](_figures/quick-start/create-app-namespace.png)
***

## <span id="jump2">1.1.2 添加应用</span>

操作如下：

**2）点击左侧菜单栏「应用」，进入应用管理界面**

**3）点击「添加应用」，选择创建方式为「基于镜像创建」**

?> **基于镜像创建：**应用基于镜像中心的镜像创建，需要自行配置应用下服务间依赖。<br>
 **从应用市场创建：**应用基于应用市场的应用模版创建，一键创建，实现自运维。
 
**4）填写「应用名」**
!> **命名规则：**2-30位的小写字母、数字，开头为字母

**5）点击「添加服务」**
***

## <span id="jump3">1.1.3 添加服务</span> 

![](_figures/quick-start/create-app-5.png) 

服务是kubernetes的service概念，真正管理了容器实例。通过对服务进行操作可以实现容器规格的升级和降级，容器数量的扩容和缩容。用户也可以通过 **<服务名>:<服务端口>** 实现同一个集群同一个空间下服务的互相访问。服务类型分为「有状态服务」和「无状态服务」两种类型。

?> **有状态服务：**用于持久化存储数据，需要挂「存储卷」。只能单容器实例。    
   **无状态服务：**不能持久化存储数据。支持多容器实例，允许做「服务伸缩」。

### <span id="jump31">1.1.3.1 创建无状态服务</span>

**1. 服务名：**填写服务名

!> **命名规则：**2-30位的小写字母、数字，开头为字母

**2. 服务类型：**选择「无状态」

**3. 镜像地址：**点击「选择镜像」。挑选需要部署的服务镜像，点击「部署」icon

?> **公有镜像：**集群内所有用户可见<br>
   **私有镜像：**当前空间下用户可见<br>
   
![](_figures/quick-start/create-app-images-center.png) 

**4. 容器规格**：提供6种容器规格

?> **1U1G：**单个容器配1个CPU核和1G内存资源  
   **1U2G：**单个容器配1个CPU核和2G内存资源  
   **2U2G：**单个容器配2个CPU核和2G内存资源  
   **2U4G：**单个容器配2个CPU核和4G内存资源    
   **4U8G：**单个容器配4个CPU核和8G内存资源    
   **8U16G：**单个容器配8个CPU核和16G内存资源      

**5. 容器数量**：服务下的容器实例数。服务运行中时，也可以通过「服务伸缩」进行数量的扩所容，期间服务不中断。

**6. 网络配置**：配置服务网络，包括内网访问和外网访问的相关配置。

?> **服务端口：**服务在内网的访问端口    
   **协议类型：**服务在内网的访问协议

**如何配置内网服务之间的互相访问？**    
内网通过dns实现服务的注册发现。服务的端口暴露方式是 **<服务名>:<服务端口>**。

**如何配置服务的外网暴露：**    
服务的外网暴露需要添加「负载均衡」到服务。外网暴露适用于跨空间、跨集群的服务互访，以及外部用户的服务访问。

**7. 配置文件**：实现容器内配置文件在平台上做维护的目的。将「配置中心」的配置集挂载到容器内某个文件路径。

?> **挂载路径：**容器内部文件路径，用于存放配置文件    
   **配置集名称：**选择需要挂载的配置集。一个配置集包含多个配置项，一个配置项是一个配置文件
      
**8. 环境变量**：配置服务的「环境变量」。

> **加载方式**

?> **手动填写：**手动管理「变量值」  
   **配置中心：**通过「配置中心」的「配置项」管理「变量值」

**9. 运行目录**：容器启动后，在「运行目录」下执行命令。

**10. 执行命令**：容器启动后的执行命令。如果填写了「执行命令」，dockerfile文件中定义的执行命令会被忽略。

### <span id="jump32">1.1.3.2 创建有状态服务</span>

**1. 服务名：**填写服务名

!> **命名规则：**2-30位的小写字母、数字，开头为字母

**2. 服务类型：**选择「有状态」

**3. 镜像地址：**点击「选择镜像」。挑选需要部署的服务镜像，点击「部署」icon

?> **公有镜像：**集群内所有用户可见<br>
   **私有镜像：**当前空间下用户可见<br>

![](_figures/quick-start/create-app-images-center.png) 

**4. 容器规格**：提供6种容器规格

?> **1U1G：**单个容器配1个CPU核和1G内存资源  
   **1U2G：**单个容器配1个CPU核和2G内存资源  
   **2U2G：**单个容器配2个CPU核和2G内存资源  
   **2U4G：**单个容器配2个CPU核和4G内存资源    
   **4U8G：**单个容器配4个CPU核和8G内存资源    
   **8U16G：**单个容器配8个CPU核和16G内存资源      

**5. 容器数量**：服务下的容器实例数。「有状态服务」只能配1，且不能做「服务伸缩」。

**6. 存储卷配置**：用于持久化存储数据，只有「有状态服务」能够添加存储卷。

?> **存储名称：**下拉选择需要添加的存储卷(如果没有可用存储卷，也可以临时创建新的存储卷)    
   **读写方式：**服务对存储卷的操作权限，分读写和只读   
   **挂载路径：**存储卷映射到容器内部的路径       

**7. 网络配置**：配置服务网络，包括内网访问和外网访问的相关配置。

?> **服务端口：**服务在内网的访问端口    
   **协议类型：**服务在内网的访问协议

**如何配置内网服务之间的互相访问？**    
内网通过dns实现服务的注册发现。服务的端口暴露方式是 **<服务名>:<服务端口>**。

**如何配置服务的外网暴露：**    
服务的外网暴露需要添加「负载均衡」到服务。外网暴露适用于跨空间、跨区域的服务互访，以及外部用户的服务访问。

**8. 配置文件**：实现容器内配置文件在平台上做维护的目的。将「配置中心」的配置集挂载到容器内某个文件路径。

?> **挂载路径：**容器内部文件路径，用于存放配置文件    
   **配置集名称：**选择需要挂载的配置集。一个配置集包含多个配置项，一个配置项是一个配置文件。
      
**9. 环境变量**：配置服务的「环境变量」。

> **加载方式**

?> **手动填写：**手动管理「变量值」  
   **配置中心：**通过「配置中心」的「配置项」管理「变量值」

**10. 运行目录**：容器启动后，在「运行目录」下执行命令。

**11. 执行命令**：容器启动后的执行命令。如果填写了「执行命令」，dockerfile文件中定义的执行命令会被忽略。