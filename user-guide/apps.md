# 2.11 应用市场
应用市场包含了三款数据库产品：MySQL、Redis、MongoDB。用户基于应用市场创建应用，只需通过填写表单就能够一键创建出具备高可用、自运维特性的应用。
***

## 2.11.1 属性说明
**1. 应用名称：**应用的名称

!> **命名空间：**2-30位的小写字母、数字，开头为字母

**2. 资源规格：**提供6种容器规格

?> **1U1G：**单个容器配1个CPU核和1G内存资源  
   **1U2G：**单个容器配1个CPU核和2G内存资源  
   **2U2G：**单个容器配2个CPU核和2G内存资源  
   **2U4G：**单个容器配2个CPU核和4G内存资源    
   **4U8G：**单个容器配4个CPU核和8G内存资源    
   **8U16G：**单个容器配8个CPU核和16G内存资源

**3. 存储容量：**最小为1G，最大为1024G，调整的最小粒度为1G

**4. 每天定时备份时刻：**每天定时自动备份的时刻

**5. 备份保留时长：**最小为3天，最大为365天，调整的最小粒度为1天

**6. 初始Root密码：**6-32个字符
***

## 2.11.2 MySQL应用
MySQL应用是基于Percona XtraDB Cluster集群方案的三主节点架构，实例间会基于Galera Replication技术实现数据的实时同步。在单节点或者两节点出现不可用时，不会影响应用的可用性。MySQL版本为5.7。

### 2.11.2.1 基本信息
**1）部署状态：**分为开始时间、结束时间、阶段三个属性

?> **开始时间：**集群开始创建的时间<br>
   **结束时间：**集群初始化结束，应用可用的时间<br>
   **阶段：**分为`创建中`、`创建成功`、`创建失败`三个阶段

**2）集群健康：**分为集群、节点、是否在修复三个属性

?> **集群：**分为`可用`、`部分可用`、`异常`三种状态。`可用`代表三个节点状态均为`green`，整个集群完全正常且可用；`部分可用`代表存在`green`的节点，但是其他节点为`red`或者`yellow`，集群存在异常，但是不影响可用性；`异常`代表三个节点均为`red`，整个集群不可用<br>
   **节点：** 	"pod name:节点状态"，其中节点状态分为`red`和`yelloW`、`green`。`red`代表该节点异常，不可用；`yellow`代表该节点存在异常，但是仍可以正常读写，不影响可用性;`green`代表该节点正常，完全可用<br>
   **是否在修复：**是否有节点正在自我修复
   
**3）访问地址：**mysql的`service-ip`。mysql应用通过`service-ip`暴露自己的访问方式，kubernetes能够将对`service-ip`的访问自动解析到应用容器

### 2.11.2.2 备份恢复
MySQL应用的备份/恢复提供手动和自动两种模式。<BR>
**1）最近恢复：**分为恢复开始、结束时间、恢复阶段三个属性

?> **恢复时间：**应用开始恢复的时间<br>
   **结束时间：**备份数据已经恢复完成的时间<br>
   **恢复阶段：**分为`恢复中`、`恢复成功`、`恢复失败`三个阶段
   
**2）备份：**：包括「立即备份」和「恢复此备份」的操作，以及每次备份的记录。<br>
点击「立即备份」，会要求填写该备份需要保留的时长，如果超出时长，该备份就会被永久删除。<br>
点击「恢复此备份」，就会手动触发该备份的手动回复。

?> **任务ID：**此次备份的ID<br>
   **备份名称：**此次备份的名称<br>
   **开始时间：**此次备份开始的时间<br>
   **结束时间：**此次备份结束的时间<br>
   **备份状态：**此次备份的状态，分为`备份中`、`备份成功`、`备份失败`
   
### 2.11.2.3 监控
监控分为资源监控和引擎监控。

?> **资源监控：**包括集群内每个节点的CPU利用率、内存利用率。整个集群的入口流量和出口流量。<br>
   **引擎监控：**包括链接频率、select/insert/update/delete频率、connect aborted、cluster error
***

## 2.11.3 Redis应用
Redis应用是基于三哨兵节点和主从数据节点架构设计的高可用方案。Redis版本为4.0.6。

### 2.11.3.1 基本信息
**1）部署状态：**分为开始时间、结束时间、阶段三个属性

?> **开始时间：**集群开始创建的时间<br>
   **结束时间：**集群初始化结束，应用可用的时间<br>
   **阶段：**分为`创建中`、`创建成功`、`创建失败`三个阶段

**2）集群健康：**分为集群、节点、是否在修复三个属性

?> **集群：**分为`可用`、`部分可用`、`异常`三种状态。`可用`代表五个节点状态均为`green`，整个集群完全正常且可用；`部分可用`代表存在`green`的数据节点，但是有其他为`red`或者`yellow`的节点，集群存在异常，但是不影响可用性；`异常`代表两个数据节点均为`red`，整个集群不可用<br>
   **节点：**	"pod name:节点状态"，其中节点状态分为`red`和`yelloW`、`green`。`red`代表该节点异常，不可用；`yellow`代表该节点存在异常，如果是数据节点仍可以正常读写，如果是哨兵节点仍可以做主备切换，不影响可用性;`green`代表该节点正常，完全可用<br>
   **是否在修复：**是否有节点正在自我修复
   
**3）访问地址：**redis的`service-name`。redis应用通过`service-name`暴露自己的访问方式，kubernetes能够将对`service-name`的访问自动解析到应用容器

### 2.11.3.2 备份恢复
Redis应用的备份/恢复提供手动和自动两种模式。<br>
**1）最近恢复：**分为恢复开始、结束时间、恢复阶段三个属性

?> **恢复时间：**应用开始恢复的时间<br>
   **结束时间：**备份数据已经恢复完成的时间<br>
   **恢复阶段：**分为`恢复中`、`恢复成功`、`恢复失败`三个阶段
   
**2）备份：**：包括「立即备份」和「恢复此备份」的操作，以及每次备份的记录。<br>
点击「立即备份」，会要求填写该备份需要保留的时长，如果超出时长，该备份就会被永久删除。<br>
点击「恢复此备份」，就会手动触发该备份的手动回复。

?> **任务ID：**此次备份的ID<br>
   **备份名称：**此次备份的名称<br>
   **开始时间：**此次备份开始的时间<br>
   **结束时间：**此次备份结束的时间<br>
   **备份状态：**此次备份的状态，分为`备份中`、`备份成功`、`备份失败`
   
### 2.11.3.3 监控
监控分为资源监控和引擎监控。

?> **资源监控：**包括五个主节点的CPU利用率、内存利用率，两个数据节点的磁盘利用率、入口流量和出口流量。
   **引擎监控：**包括Cache Hit Ratio、Master Slave IO Seconds、Total Keys、Active Connections、Top5 Commands Executed
***

## 2.11.4 MongoDB应用
MongoDB应用是基于裁判节点和主从数据节点架构设计的高可用方案。MongoDB的版本是3.4。

### 2.11.4.1 基本信息
**1）部署状态：**分为开始时间、结束时间、阶段三个属性

?> **开始时间：**集群开始创建的时间<br>
   **结束时间：**集群初始化结束，应用可用的时间<br>
   **阶段：**分为`创建中`、`创建成功`、`创建失败`三个阶段

**2）集群健康：**分为集群、节点、是否在修复三个属性

?> **集群：**分为`可用`、`部分可用`、`异常`三种状态。`可用`代表三个节点状态均为`green`，整个集群完全正常且可用；`部分可用`代表存在`green`的数据节点，但是有其他为`red`或者`yellow`的节点，集群存在异常，但是不影响可用性；`异常`代表两个数据节点均为`red`，整个集群不可用<br>
   **节点：**	"pod name:节点状态"，其中节点状态分为`red`和`yelloW`、`green`。`red`代表该节点异常，不可用；`yellow`代表该节点存在异常，如果是数据节点仍可以正常读写，如果是裁判节点仍可以做主备切换，不影响可用性;`green`代表该节点正常，完全可用<br>
   **是否在修复：**是否有节点正在自我修复
   
**3）访问地址：**`<应用ID>/<pod-name1>,<pod-name2>`。MongoDB通过`<应用ID>/<pod-name1>,<pod-name2>`暴露自己的访问方式，kubernetes能够将对``<应用ID>/<pod-name1>,<pod-name2>`的访问自动解析到应用容器。

### 2.11.4.2 备份恢复
MongoDB应用的备份/恢复提供手动和自动两种模式。<br>
**1）最近恢复：**分为恢复开始、结束时间、恢复阶段三个属性

?> **恢复时间：**应用开始恢复的时间<br>
   **结束时间：**备份数据已经恢复完成的时间<br>
   **恢复阶段：**分为`恢复中`、`恢复成功`、`恢复失败`三个阶段
   
**2）备份：**：包括「立即备份」和「恢复此备份」的操作，以及每次备份的记录。<br>
点击「立即备份」，会要求填写该备份需要保留的时长，如果超出时长，该备份就会被永久删除。<br>
点击「恢复此备份」，就会手动触发该备份的手动回复。

?> **任务ID：**此次备份的ID<br>
   **备份名称：**此次备份的名称<br>
   **开始时间：**此次备份开始的时间<br>
   **结束时间：**此次备份结束的时间<br>
   **备份状态：**此次备份的状态，分为`备份中`、`备份成功`、`备份失败`
